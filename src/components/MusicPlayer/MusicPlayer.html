<div v-if="tableShow === 1" class="tableShow_config">
    <div class="tableShow_form">
        <div class="tableShow_header">
            <span class="header_txt">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞</span>
            <span class="header_button" @click="Chng_tableShow()">X</span>
        </div>
        <div class="tableShow_content">
            <div class="tableShow_content_elem">‚Ññ: <input type="checkbox" name="tabTag_id" id="tabTag_id" :checked="showTagsData.id"></div>
            <div class="tableShow_content_elem">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: <input type="checkbox" name="tabTag_artist" id="tabTag_artist" :checked="showTagsData.artist"></div>
            <div class="tableShow_content_elem">–ê–ª—å–±–æ–º: <input type="checkbox" name="tabTag_album" id="tabTag_album" :checked="showTagsData.album"></div>
            <div class="tableShow_content_elem">–ù–∞–∑–≤–∞–Ω–∏–µ: <input type="checkbox" name="tabTag_title" id="tabTag_title" :checked="showTagsData.title"></div>
            <div class="tableShow_content_elem">–ñ–∞–Ω—Ä: <input type="checkbox" name="tabTag_genre" id="tabTag_genre" :checked="showTagsData.genre"></div>
            <div class="tableShow_content_elem">–í—Ä–µ–º—è: <input type="checkbox" name="tabTag_duration" id="tabTag_duration" :checked="showTagsData.duration"></div>
            <div class="tableShow_butpannel">
                <span class="button_suc" @click="Upd_tableShow()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</span>
                <span class="button_err" @click="Chng_tableShow()">–û—Ç–º–µ–Ω–∏—Ç—å</span>
            </div>
        </div>        
    </div>
</div>

<div class="playlist">
    <div class="controlpanel">
        <div class="f_cover">
            <svg id="svg_cover" class="bi" width="99" height="99" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#disc-fill" :class="(Play) ? 'rotating_rect' : ''"/></svg>
        </div>
        <div class="f_panel">
            <div class="track_name">
                <span v-if="currentTrack">{{currentTrack.name}}</span>
            </div>
            <div class="track_time">
                <i>{{(TrackTime && TrackTime.current !== 0) ? ShowerTime(TrackTime.current) : '00:00'}}</i> / <i>{{(TrackTime && TrackTime.duration !== 0) ? ShowerTime(TrackTime.duration) : '00:00'}}</i>
            </div>
            <div class="track_timeline">
                <audio id="main_audio" controls @ended="onAudioEnded" :src="(currentTrack) ? currentTrack.url : ''" style="display: none;" :volume="VolumeLvl" @timeupdate="onTimeUpdate"  />
                <input id="main_tracktime" class="track_rangetime" type="range" min="0" :max="TrackTime.duration" value="0" @change="Chng_TrackRangeTime()" />
            </div>
            <div class="track_buttons">
                <!-- Previous track -->
                <div class="track_buttons_elem" @click="PlayerAction_PrevTrk()">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#skip-backward-fill"/></svg>
                </div>
                <!-- Pause -->
                <div class="track_buttons_elem" @click="PlayerAction_Pause()">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#stop-fill"/></svg>
                </div>
                <!-- Play -->
                <div class="track_buttons_elem" @click="PlayerAction_Play()">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#play-fill"/></svg>
                </div>
                <!-- Next track -->
                <div class="track_buttons_elem" @click="PlayerAction_NextTrk()">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#skip-forward-fill"/></svg>
                </div>
            </div>
            <div class="track_buttons">
                <!-- Repeat mode: single track -->
                <div v-if="RepeatMode == 'one'" class="track_buttons_elem" @click="Chng_RepeatMode()" title="–†–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞: –æ–¥–∏–Ω —Ç—Ä–µ–∫">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#arrow-clockwise"/></svg>
                </div>
                <!-- Repeat mode: playlist -->
                <div v-else-if="RepeatMode == 'all'" class="track_buttons_elem" @click="Chng_RepeatMode()" title="–†–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞: –ø–ª–µ–π–ª–∏—Å—Ç">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#arrow-repeat"/></svg>
                </div>
                <!-- Repeat mode: off -->
                <div v-else class="track_buttons_elem" @click="Chng_RepeatMode()" title="–†–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞: –≤—ã–∫–ª—é—á–µ–Ω">
                    <svg class="bi" width="25" height="25" fill="currentColor" style="opacity: .5;"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#arrow-clockwise"/></svg>
                </div>
                <!-- Random playback order (ON) -->
                <div v-if="Shuffle" class="track_buttons_elem" @click="Chng_Shuffle()">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#shuffle"/></svg>
                </div>
                <!-- Random playback order (OFF) -->
                <div v-else class="track_buttons_elem" @click="Chng_Shuffle()">
                    <svg class="bi" width="25" height="25" fill="currentColor" style="opacity: .5;"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#shuffle"/></svg>
                </div>
                <!-- Silent mode (ON) -->
                <div v-if="SilentMode" class="track_buttons_elem" @click="Chng_SilentMode()">
                    <svg class="bi" width="25" height="25" fill="currentColor"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#volume-mute-fill"/></svg>
                </div>
                <!-- Silent mode (OFF) -->
                <div v-else class="track_buttons_elem" @click="Chng_SilentMode()">
                    <svg class="bi" width="25" height="25" fill="currentColor" style="opacity: .5;"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#volume-mute-fill"/></svg>
                </div>
                

            </div>
            <div class="track_volume_elem">
                <div class="track_buttons_elem" @click="PlayerAction_VolMinus()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-dash-circle" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/>
                    </svg>
                </div>
                <div class="track_buttons_elem">VOL: {{VolumeLvl * 100}}%</div>
                <div class="track_buttons_elem" @click="PlayerAction_VolPlus()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                </div>                                
            </div>
        </div>
        <div class="f_trackinfo">
            <table v-if="currentTrack && currentTrack.common">
                <tbody>
                    <tr><td class="tagkey">{{TagsData.album}}:</td><td class="tagval">{{currentTrack.common.album ?? ''}}</td></tr>
                    <tr><td class="tagkey">albumartist:</td><td class="tagval">{{currentTrack.common.albumartist ?? ''}}</td></tr>
                    <tr>
                        <td class="tagkey">{{TagsData.artist}}:</td>
                        <td v-if="currentTrack.common?.artists" class="tagval">
                            <!-- {{currentTrack.common.artists ?? currentTrack.common.artist ?? ''}} -->
                            <div v-for="artVal in (currentTrack.common?.artists || [])">{{artVal}}</div>
                        </td>
                        <td v-else-if="currentTrack.common?.artist" class="tagval">
                            {{currentTrack.common.artist}}
                        </td>
                        <td v-else class="tagval"></td>
                    </tr>
                    <tr><td class="tagkey">–î–∏—Å–∫:</td><td class="tagval">{{(currentTrack.common.disk && currentTrack.common.disk.no && currentTrack.common.disk.of) ? (currentTrack.common.disk.no + ' ' + currentTrack.common.disk.of) : ''}}</td></tr>
                    <tr>
                        <td class="tagkey">{{TagsData.genre}}:</td>
                        <td class="tagval">
                            <div v-for="gVal in (currentTrack.common?.genre || [])">{{gVal}}</div>
                        </td>
                    </tr>
                    <tr><td class="tagkey">{{TagsData.title}}:</td><td class="tagval">{{currentTrack.common.title ?? ''}}</td></tr>
                    <tr><td class="tagkey">{{TagsData.track_no}}:</td><td class="tagval">{{(currentTrack.common.track && currentTrack.common.track.no && currentTrack.common.track.of) ? (currentTrack.common.track.no + ' ' + TagsData.track_of + ' ' + currentTrack.common.track.of) : ''}}</td></tr>
                    <tr><td class="tagkey">{{TagsData.year}}:</td><td class="tagval">{{currentTrack.common.year ?? ''}}</td></tr>
                </tbody>
            </table>
            
        </div>
    </div>    
    <div class="playlist_arr">
        <div class="playlist_name">–ù–æ–≤—ã–π –ø–ª–µ–π–ª–∏—Å—Ç</div>
        <MusicUploader @files-selected="onFilesSelected" />
        <!-- <span class="playlist_tabConfig" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è" @click="Chng_tableShow()">‚öôÔ∏è</span> -->
        <span class="playlist_tabConfig" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è" @click="Chng_tableShow()">
            <svg class="bi" width="18" height="18" fill="currentColor" style="color: white;"><use xlink:href="~/bootstrap-icons/bootstrap-icons.svg#ui-checks-grid"/></svg>
        </span>
        <div class="music_playlist">
            <table v-if="preparedTracks && preparedTracks.length > 0">
                <thead>
                    <tr class="table-header">
                        <th v-if="tableShowConfig.id">‚Ññ</th>
                        <th v-if="tableShowConfig.artist">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</th>
                        <th v-if="tableShowConfig.album">–ê–ª—å–±–æ–º</th>
                        <th v-if="tableShowConfig.genre">–ñ–∞–Ω—Ä</th>
                        <th v-if="tableShowConfig.title">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th v-if="tableShowConfig.duration">–í—Ä–µ–º—è</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(track, index) in preparedTracks" :key="track.id" :class="{ active: currentTrack && track.id === currentTrack.id }" @click="SelectedTrack(index)" class="track-row">
                    <!-- <tr v-for="(track, index) in preparedTracks" :key="track.id" :class="{ active: currentTrack && track.id === currentTrack.id }" @click="SelectedTrack(track)" class="track-row"> -->
                        <td v-if="tableShowConfig.id" class="track-number">{{ index + 1 }}</td>
                        <td v-if="tableShowConfig.artist" class="track-artist">{{ track.common?.artist || '–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω' }}</td>
                        <td v-if="tableShowConfig.album" class="track-album">{{ track.common?.album || '–ë–µ–∑ –∞–ª—å–±–æ–º–∞' }}</td>
                        <td v-if="tableShowConfig.genre" class="track-genre">
                            <div v-for="gVal in (track.common?.genre || [])">{{gVal}}</div>
                        </td>
                        <td v-if="tableShowConfig.title" class="track-title" :title="track.name">{{ track.name }}</td>
                        <td v-if="tableShowConfig.duration" class="track-duration">{{ track.duration ? formatDuration(track.duration) : '--:--' }}</td>
                    </tr>
                </tbody>
            </table>    
            <div v-else class="empty-state">
                <p>üéµ –ù–µ—Ç —Ç—Ä–µ–∫–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
                <p class="empty-hint">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –º—É–∑—ã–∫—É —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –≤—ã—à–µ</p>
            </div>    
        </div>
    </div>    
</div>